<aside class="sidebar-left">
  <div class="sidebar-layout">
    <div class="sidebar-header">
      <div class="logo-container">
        <div class="logo-wrapper">
          <a routerLink="/home">
            <img alt="Rivaly Logo"
                 class="main-logo"
                 src="/rivaly-icon-1x.ico">
          </a>
        </div>
      </div>
    </div>

    <div class="sidebar-content">
      <nav class="sidebar-menu">
        <!-- NAVIGATE -->
        <ul class="menu-section">
          <li class="sidebar-menu-header">
            <span class="header-text item-description">ARENA</span>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" routerLink="/home">
              <span class="sidebar-menu-icon">
                <i class="fa fa-house"></i>
              </span>
              <span class="menu-title item-description">Home</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" routerLink="/live-matches">
              <span class="sidebar-menu-icon">
                <i class="fa fa-tv"></i>
              </span>
              <span class="menu-title item-description">Live Matches</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" routerLink="/highlights">
              <span class="sidebar-menu-icon">
                <i class="fa fa-star"></i>
              </span>
              <span class="menu-title item-description">Highlights</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" routerLink="/leaderboards">
              <span class="sidebar-menu-icon">
                <i class="fa fa-medal"></i>
              </span>
              <span class="menu-title item-description">Leaderboards</span>
            </a>
          </li>
        </ul>
        <div class="divider"></div>

        <!-- COMPETITIONS -->
        <ul class="menu-section">
          <li class="sidebar-menu-header">
            <span class="header-text item-description">COMPETITIONS</span>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" routerLink="/tournaments">
              <span class="sidebar-menu-icon">
                <i class="fa fa-trophy"></i>
              </span>
              <span class="menu-title item-description">Tournaments</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" routerLink="/matches">
              <span class="sidebar-menu-icon">
                <i class="fa fa-flag-checkered"></i>
              </span>
              <span class="menu-title item-description">Matches</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" routerLink="/calendar">
              <span class="sidebar-menu-icon">
                <i class="fa fa-calendar-days"></i>
              </span>
              <span class="menu-title item-description">Calendar</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/results">
              <span class="sidebar-menu-icon">
                <i class="fa fa-list-ol"></i>
              </span>
              <span class="menu-title item-description">Results</span>
            </a>
          </li>
        </ul>
        <div class="divider"></div>

        <!-- TEAMS -->
        <ul class="menu-section">
          <li class="sidebar-menu-header">
            <span class="header-text item-description">TEAMS & PLAYERS</span>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/teams">
              <span class="sidebar-menu-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="menu-title item-description">Teams</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/athletes">
              <span class="sidebar-menu-icon">
                <i class="fa fa-person-running"></i>
              </span>
              <span class="menu-title item-description">Athletes</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/members">
              <span class="sidebar-menu-icon">
                <i class="fa fa-user-group"></i>
              </span>
              <span class="menu-title item-description">Members</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/schools">
              <span class="sidebar-menu-icon">
                <i class="fa fa-school"></i>
              </span>
              <span class="menu-title item-description">Schools</span>
            </a>
          </li>
        </ul>
        <div class="divider"></div>

        <!-- PERFORMANCE -->
        <ul class="menu-section">
          <li class="sidebar-menu-header">
            <span class="header-text item-description">PERFORMANCE</span>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/rankings">
              <span class="sidebar-menu-icon">
                <i class="fa fa-ranking-star"></i>
              </span>
              <span class="menu-title item-description">Rankings</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/stats-records">
              <span class="sidebar-menu-icon">
                <i class="fa fa-chart-line"></i>
              </span>
              <span class="menu-title item-description">Stats & Records</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/season-history">
              <span class="sidebar-menu-icon">
                <i class="fa fa-clock-rotate-left"></i>
              </span>
              <span class="menu-title item-description">Season History</span>
            </a>
          </li>
        </ul>
        <div class="divider"></div>

        <!-- MANAGEMENT (ADMIN ONLY) -->
        <ul class="menu-section">
          <li class="sidebar-menu-header">
            <span class="header-text item-description">MANAGEMENT</span>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/event-setup">
              <span class="sidebar-menu-icon">
                <i class="fa fa-calendar-plus"></i>
              </span>
              <span class="menu-title item-description">Event Setup</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/user-control">
              <span class="sidebar-menu-icon">
                <i class="fa fa-user-gear"></i>
              </span>
              <span class="menu-title item-description">User Control</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/system-settings">
              <span class="sidebar-menu-icon">
                <i class="fa fa-gear"></i>
              </span>
              <span class="menu-title item-description">System Settings</span>
            </a>
          </li>
        </ul>
        <div class="divider"></div>

        <!-- INFO & MEDIA -->
        <ul class="menu-section">
          <li class="sidebar-menu-header">
            <span class="header-text item-description">INFO & MEDIA</span>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/news">
              <span class="sidebar-menu-icon">
                <i class="fa fa-newspaper"></i>
              </span>
              <span class="menu-title item-description">News</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/rules-guidelines">
              <span class="sidebar-menu-icon">
                <i class="fa fa-scale-balanced"></i>
              </span>
              <span class="menu-title item-description">Rules & Guidelines</span>
            </a>
          </li>
          <li class="sidebar-menu-item">
            <a class="menu-link" href="/support">
              <span class="sidebar-menu-icon">
                <i class="fa fa-circle-question"></i>
              </span>
              <span class="menu-title item-description">Support</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>

    <!-- User Sidebar -->
    <div class="sidebar-footer">
      <ng-container *ngIf="currentUser$ | async as user; else guestView">
        <div class="user-content">
          <a [routerLink]="['/profile', user.id]" class="user-avatar" title="Ver Perfil">
            <!-- Usa diretamente a URL da foto vinda do banco ou uma imagem padrão -->
            <img
              [alt]="'Avatar de ' + user.name"
              [src]="getUserProfilePhotoUrl(user)">
          </a>
          <div class="user-info">
            <a [routerLink]="['/profile', user.id]" class="user-name item-description" title="Ver Perfil">
              {{ user.name }}
            </a>
            <span class="user-role item-description">{{ user.global_role || 'Membro' }}</span>
          </div>
          <div class="user-actions">
            <button (click)="toggleSettings()"
                    [class.active]="isSettingsOpen"
                    class="action-btn settings-btn"
                    title="Configurações"
                    type="button">
              <i class="fa fa-bars"></i>
            </button>
          </div>
        </div>
      </ng-container>

      <ng-template #guestView>
        <div class="user-content">
          <a class="menu-link" routerLink="/login">
            <span class="sidebar-menu-icon">
              <i class="fa fa-sign-in-alt"></i>
            </span>
            <span class="menu-title item-description">Fazer Login</span>
          </a>
        </div>
      </ng-template>

      <!-- Settings Popup -->
      <div [class.open]="isSettingsOpen" class="settings-popup">
        <div (click)="$event.stopPropagation()" class="settings-content">
          <div class="settings-header">
            <h3>Configurações</h3>
            <button (click)="closeSettings()" class="close-btn" type="button">
              <i class="fa fa-times"></i>
            </button>
          </div>

          <div class="settings-body">
            <!-- CONFIGURAÇÃO DE TEMA -->
            <div class="setting-item">
              <div class="setting-info">
                <span class="setting-title">Tema</span>
                <span class="setting-description">
                  {{ isDarkMode ? 'Modo Escuro' : 'Modo Claro' }}
                </span>
              </div>
              <div (click)="toggleTheme()" class="theme-toggle">
                <div [class.active]="isDarkMode" class="toggle-switch">
                  <div class="toggle-slider">
                    <i [class.fa-moon]="isDarkMode" [class.fa-sun]="!isDarkMode" class="fa"></i>
                  </div>
                </div>
              </div>
            </div>

            <!-- DIVISOR -->
            <div class="setting-divider"></div>

            <!-- BOTÃO DE LOGOUT -->
            <div class="setting-item">
              <button (click)="onLogout()" class="logout-setting-btn" type="button">
                <div class="logout-content">
                  <i class="fas fa-sign-out-alt"></i>
                  <div class="logout-text">
                    <span class="logout-title">Sair da Conta</span>
                  </div>
                </div>
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Overlay para fechar o popup -->
      <div (click)="onOverlayClick($event)"
           [class.active]="isSettingsOpen"
           [style.display]="isSettingsOpen ? 'block' : 'none'"
           class="settings-overlay">
      </div>
    </div>
  </div>
</aside>
